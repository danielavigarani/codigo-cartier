<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Código Cartier - Ordem Paranormal</title>

    <meta name="description" content="Ferramenta de Criptografia Musical baseada em Ordem Paranormal. Traduza textos para notas musicais e vice-versa." />

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Courier+Prime:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0"
      rel="stylesheet"
    />
    <!-- VERSÃO DO CSS (Cache Busting) -->
    <link href="style.css?v=2.1" rel="stylesheet" />
  </head>
  <body
    class="min-h-screen flex flex-col items-center pb-12 relative overflow-x-hidden"
  >
    <div class="fixed inset-0 z-0 opacity-20 pointer-events-none">
      <img
        alt=""
        class="w-full h-full object-cover"
        src="background.svg"
      />
      <div
        class="absolute inset-0 bg-gradient-to-b from-[#0f172a] via-transparent to-[#0f172a]"
      ></div>
    </div>

    <header
      class="relative z-10 w-full max-w-4xl px-6 py-8 text-center border-b border-slate-700 flex flex-col items-center"
    >
      <h1
        class="text-5xl md:text-6xl text-amber-500 mb-2 tracking-wide font-bold italic drop-shadow-lg"
      >
        Código Cartier
      </h1>
      <p class="text-slate-400 text-sm md:text-base max-w-2xl mx-auto italic">
        "Onde as palavras falham, a música fala." — Ferramenta de Criptografia
        Musical.
      </p>

      <div class="mt-6" id="audio-overlay">
        <button
          class="group relative inline-flex items-center justify-center px-8 py-3 text-base font-medium text-white bg-slate-800 border border-amber-500/50 rounded-full hover:bg-amber-900/30 transition-all shadow-[0_0_15px_rgba(245,158,11,0.2)]"
          onclick="initAudio()"
        >
          <span class="material-symbols-outlined mr-2 group-hover:animate-pulse" aria-hidden="true"
            >music_note</span
          >
          Iniciar Sessão Musical (Ativar Áudio)
        </button>
        <p class="text-xs text-slate-500 mt-2">
          (Clique para permitir que o navegador toque os sons)
        </p>
      </div>

      <div
        class="mt-6 hidden justify-center items-center gap-4 animate-fade-in w-full"
        id="audio-controls"
      >
        <div
          class="relative bg-slate-800 rounded-full p-1.5 border border-slate-700 shadow-lg flex w-full max-w-[400px] h-16 mx-auto"
        >
          <div
            id="instrument-slider"
            class="absolute top-1.5 bottom-1.5 left-1.5 w-[calc(50%-6px)] bg-amber-600 rounded-full transition-transform duration-300 ease-out shadow-md z-0"
          ></div>

          <button
            class="relative z-10 w-1/2 h-full rounded-full flex flex-col justify-center items-center leading-tight transition-colors duration-300 text-white"
            id="btn-piano"
            onclick="setInstrument('piano')"
          >
            <span class="text-base font-bold">Piano</span>
            <span class="text-[11px] opacity-90 font-normal tracking-wide"
              >(Agilidade)</span
            >
          </button>

          <button
            class="relative z-10 w-1/2 h-full rounded-full flex flex-col justify-center items-center leading-tight transition-colors duration-300 text-slate-400 hover:text-white"
            id="btn-cello"
            onclick="setInstrument('cello')"
          >
            <span class="text-base font-bold">Violoncelo</span>
            <span class="text-[11px] opacity-90 font-normal tracking-wide"
              >(Emoção)</span
            >
          </button>
        </div>

        <button
          onclick="toggleMute()"
          class="w-10 h-10 flex-shrink-0 rounded-full bg-slate-700 hover:bg-slate-600 border border-slate-600 flex items-center justify-center shadow-lg transition-all text-amber-500 group"
            aria-label="Alternar som"
          title="Mutar/Desmutar"
        >
          <div id="icon-sound-on" class="block">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              fill="currentColor"
              viewBox="0 0 256 256"
            >
              <path
                d="M160,32.25V223.69a8.29,8.29,0,0,1-3.91,7.18,8,8,0,0,1-9-.56l-65.57-51A4,4,0,0,1,80,176.16V79.84a4,4,0,0,1,1.55-3.15l65.57-51a8,8,0,0,1,10,.16A8.27,8.27,0,0,1,160,32.25ZM60,80H32A16,16,0,0,0,16,96v64a16,16,0,0,0,16,16H60a4,4,0,0,0,4-4V84A4,4,0,0,0,60,80Zm126.77,20.84a8,8,0,0,0-.72,11.3,24,24,0,0,1,0,31.72,8,8,0,1,0,12,10.58,40,40,0,0,0,0-52.88A8,8,0,0,0,186.74,100.84Zm40.89-26.17a8,8,0,1,0-11.92,10.66,64,64,0,0,1,0,85.34,8,8,0,1,0,11.92,10.66,80,80,0,0,0,0-106.66Z"
              ></path>
            </svg>
          </div>
          <div id="icon-sound-off" class="hidden">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              fill="currentColor"
              viewBox="0 0 256 256"
            >
              <path
                d="M245.66,146.34a8,8,0,0,1-11.32,11.32L216,139.31l-18.34,18.35a8,8,0,0,1-11.32-11.32L204.69,128l-18.35-18.34a8,8,0,0,1,11.32-11.32L216,116.69l18.34-18.35a8,8,0,0,1,11.32,11.32L227.31,128ZM60,80H32A16,16,0,0,0,16,96v64a16,16,0,0,0,16,16H60a4,4,0,0,0,4-4V84A4,4,0,0,0,60,80Zm97.15-54.15a8,8,0,0,0-10-.16l-65.57,51A4,4,0,0,0,80,79.84v96.32a4,4,0,0,0,1.55,3.15l65.57,51a8,8,0,0,0,9,.56,8.29,8.29,0,0,0,3.91-7.18V32.25A8.27,8.27,0,0,0,157.12,25.85Z"
              ></path>
            </svg>
          </div>
        </button>
      </div>
    </header>

    <main class="relative z-10 w-full max-w-5xl px-4 mt-8">
      <div class="flex flex-wrap justify-center mb-8 border-b border-slate-700">
        <button
          class="px-4 md:px-6 py-3 border-b-2 hover:bg-slate-800/50 transition-colors flex items-center border-amber-500 text-amber-500 font-bold"
          id="tab-encrypt"
          onclick="switchTab('encrypt')"
        >
          <span class="material-symbols-outlined mr-2 text-sm" aria-hidden="true">lock</span>
          Cifrar (Esconder)
        </button>
        <button
          class="px-4 md:px-6 py-3 border-b-2 hover:text-amber-500 hover:border-amber-500/50 transition-colors flex items-center border-transparent text-slate-400"
          id="tab-decrypt"
          onclick="switchTab('decrypt')"
        >
          <span class="material-symbols-outlined mr-2 text-sm" aria-hidden="true">lock_open</span>
          Decifrar (Revelar)
        </button>
        <button
          class="px-4 md:px-6 py-3 border-b-2 hover:text-amber-500 hover:border-amber-500/50 transition-colors flex items-center border-transparent text-slate-400"
          id="tab-legend"
          onclick="switchTab('legend')"
        >
          <span class="material-symbols-outlined mr-2 text-sm" aria-hidden="true">menu_book</span>
          Manual & Teoria
        </button>
      </div>

      <section class="w-full animate-fade-in" id="panel-encrypt">
        <div
          class="bg-slate-800/80 backdrop-blur-md rounded-xl p-6 border border-slate-700 shadow-2xl"
        >
          <div class="flex justify-between items-center mb-2">
            <label
              class="block text-amber-500 text-sm font-bold uppercase tracking-wider"
              for="input-text"
              >ESCREVA COM O CORAÇÃO</label
            >
            <button
              onclick="toggleSecretMode()"
              class="flex items-center text-xs text-slate-400 hover:text-amber-500 transition-colors uppercase font-bold"
              title="Ocultar texto para transmissão"
            >
              <span
                class="material-symbols-outlined text-sm mr-1" aria-hidden="true"
                id="icon-secret"
                >visibility</span
              >
              <span id="text-secret">Modo Público</span>
            </button>
          </div>

          <textarea
            class="w-full bg-slate-900/50 text-white border border-slate-600 rounded-lg p-4 focus:outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-all font-mono text-lg uppercase shadow-inner custom-placeholder"
            id="input-text"
            placeholder="Digite aqui..."
            rows="4"
          ></textarea>

          <div class="flex flex-wrap gap-4 justify-between items-center mt-4">
            <button
              class="bg-amber-600 hover:bg-amber-500 text-white font-bold py-2 px-6 rounded-lg shadow-lg transform hover:-translate-y-0.5 transition-all flex items-center"
              onclick="encryptText()"
            >
              <span class="material-symbols-outlined mr-2" aria-hidden="true">piano</span> Traduzir
              para Notas
            </button>

            <button
              class="text-slate-400 bg-slate-800/50 hover:bg-slate-700 hover:text-white text-xs py-2 px-4 rounded-full transition-all border border-slate-700"
              onclick="clearEncrypt()"
            >
              Limpar Tudo
            </button>
          </div>

          <div
            class="mt-8 border-t border-slate-700 pt-6 hidden"
            id="encrypt-result-container"
          >
            <div class="flex justify-end gap-3 mb-6 relative z-50">
              
              <div class="relative">
                <button
                  onclick="toggleCopyMenu()"
                  aria-label="Opções de Cópia"
                  class="flex items-center justify-center w-10 h-10 bg-slate-700 rounded-full border border-slate-600 hover:bg-slate-600 transition-all text-slate-200 shadow hover:shadow-slate-500/20 active:scale-95"
                  title="Opções de Cópia"
                >
                  <span class="material-symbols-outlined text-xl" aria-hidden="true"
                    >content_copy</span
                  >
                </button>

                <div
                  id="copy-menu"
                  class="absolute right-0 top-full mt-2 w-48 bg-slate-800 border border-slate-600 rounded-lg shadow-xl hidden overflow-hidden z-50"
                >
                  <button
                    onclick="copyToClipboard('full')"
                    class="block w-full text-left px-4 py-3 text-xs text-slate-300 hover:bg-slate-700 hover:text-white border-b border-slate-700/50 transition-colors flex items-center"
                  >
                    <span class="material-symbols-outlined text-sm mr-2 opacity-70" aria-hidden="true">description</span>
                    Completo (Nota + Letra)
                  </button>
                  <button
                    onclick="copyToClipboard('code')"
                    class="block w-full text-left px-4 py-3 text-xs text-slate-300 hover:bg-slate-700 hover:text-white transition-colors flex items-center"
                  >
                    <span class="material-symbols-outlined text-sm mr-2 opacity-70" aria-hidden="true">code</span>
                    Apenas Cifra (A2 B2...)
                  </button>
                </div>
              </div>

              <button
                id="btn-play-action"
                class="flex items-center text-xs font-bold bg-slate-900 px-5 py-2 rounded-full border border-amber-900 shadow hover:shadow-amber-900/20 transition-all text-amber-400 hover:text-amber-300 active:scale-95"
                onclick="togglePlay()"
              >
                <span
                  class="material-symbols-outlined text-xl mr-2" aria-hidden="true"
                  id="icon-play"
                  >play_circle</span
                >
                <span id="text-play">Tocar</span>
              </button>
            </div>

            <div class="flex flex-col gap-6" id="encrypt-output-wrapper"></div>

            <p class="text-xs text-slate-500 mt-6 italic text-center opacity-60">
              *Clique em uma nota individual para ouvi-la.*
            </p>
          </div>
        </div>
      </section>

      <section class="w-full animate-fade-in hidden" id="panel-decrypt">
        <div
          class="bg-slate-800/80 backdrop-blur-md rounded-xl p-6 border border-slate-700 shadow-2xl"
        >
          <!-- NOVO TEXTAREA E BOTÃO -->
          <div class="mb-6">
            <label
              for="decrypt-input"
              class="block text-amber-500 text-sm font-bold uppercase tracking-wider mb-2"
              >Cole o código aqui</label
            >
            <textarea
              id="decrypt-input"
              class="w-full bg-slate-900/50 text-white border border-slate-600 rounded-lg p-4 focus:outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-all font-mono text-lg uppercase shadow-inner custom-placeholder"
              placeholder="Ex: C4 G3 | A3..."
              rows="3"
              spellcheck="false"
            ></textarea>
          </div>

          <div class="flex justify-center mb-8">
            <button
                class="bg-amber-600 hover:bg-amber-500 text-white font-bold py-3 px-8 rounded-lg shadow-lg transform hover:-translate-y-0.5 transition-all flex items-center"
                onclick="revealCode()"
            >
                <span class="material-symbols-outlined mr-2" aria-hidden="true">hearing</span>
                Ouvir & Revelar
            </button>
          </div>

          <div class="flex justify-center -mt-4 mb-8">
            <button
                id="btn-skip-reveal"
                class="hidden bg-slate-700 hover:bg-slate-600 text-white text-xs font-bold py-2 px-4 rounded-full shadow-lg transition-all flex items-center animate-fade-in"
                onclick="skipReveal()"
            >
                <span class="material-symbols-outlined mr-2" aria-hidden="true">fast_forward</span>
                Pular Animação
            </button>
          </div>
          
          <!-- SEÇÃO DE RESULTADO -->
          <div class="mb-6 relative pt-6 border-t border-slate-700">
            <div class="flex justify-between items-center mb-2">
              <label class="block text-amber-500 text-sm font-bold uppercase tracking-wider" for="decrypt-output">Mensagem Revelada</label>
              <div class="flex items-center gap-4">
                <button
                  class="text-xs text-slate-400 hover:text-white uppercase flex items-center transition-colors"
                  onclick="copyDecryptedText()"
                  title="Copiar texto revelado"
                >
                  <span class="material-symbols-outlined text-sm mr-1" aria-hidden="true">content_copy</span>
                  Copiar Texto
                </button>
                <button
                  class="text-xs text-slate-400 hover:text-white uppercase flex items-center transition-colors"
                  onclick="document.getElementById('decrypt-output').value += '\n';"
                  title="Nova Linha"
                >
                  <span class="material-symbols-outlined text-sm mr-1" aria-hidden="true">keyboard_return</span>
                  Nova Linha
                </button>
                <button
                  class="text-xs text-slate-400 hover:text-white uppercase flex items-center transition-colors"
                  onclick="document.getElementById('decrypt-output').value = document.getElementById('decrypt-output').value.slice(0, -1);"
                >
                  <span class="material-symbols-outlined text-sm mr-1" aria-hidden="true"
                    >backspace</span
                  >
                  Apagar Última
                </button>
              </div>
            </div>
            <textarea
              class="w-full bg-slate-900/50 text-amber-500 text-xl font-bold border border-slate-600 focus:outline-none p-4 tracking-wider font-mono rounded-lg shadow-inner"
              id="decrypt-output"
              readonly
              placeholder="..."
              rows="5"
              style="resize: vertical;"
            ></textarea>
            <div class="text-center text-xs text-slate-500 mt-2">
              As letras aparecerão aqui em sincronia com o áudio.
            </div>
          </div>

          <div class="flex justify-center mb-6">
            <button
              onclick="toggleHints()"
              class="flex items-center space-x-2 text-sm font-bold transition-all group bg-slate-900/50 px-4 py-2 rounded-full border border-slate-700 hover:border-amber-500/50"
              id="btn-hints"
            >
              <span
                class="material-symbols-outlined text-amber-500" aria-hidden="true"
                id="icon-hints"
                >visibility</span
              >
              <span class="text-amber-500" id="text-hints"
                >Ocultar "Cola" (Letras)</span
              >
            </button>
          </div>

          <div class="relative w-full overflow-x-auto pb-6 custom-scrollbar">
            <div
              class="flex justify-start md:justify-center min-w-max select-none px-2"
              id="piano-container"
            ></div>
          </div>

          <div
            class="mt-4 p-4 bg-amber-900/10 border border-amber-900/30 rounded text-center"
          >
            <p class="text-amber-200/80 text-sm font-serif italic">
              "O segredo está na harmonia entre o silêncio e o som."
            </p>
          </div>
        </div>
      </section>

      <section class="w-full animate-fade-in hidden" id="panel-legend">
        <div class="grid md:grid-cols-2 gap-6">
          <div
            class="bg-slate-800/90 rounded-xl p-6 border border-slate-700 shadow-lg"
          >
            <h2
              class="text-2xl text-amber-500 mb-4 cartier-font border-b border-slate-600 pb-2 flex items-center"
            >
              <span class="material-symbols-outlined mr-2" aria-hidden="true">translate</span>
              Dicionário Musical
            </h2>
            <p class="text-slate-300 mb-4 text-sm leading-relaxed">
              O Código Cartier utiliza a notação de cifras (C, D, E...) para
              representar as notas musicais.
            </p>
            <div class="grid grid-cols-1 gap-2 text-sm font-mono">
              <div
                class="flex justify-between bg-slate-700/50 p-3 rounded items-center hover:bg-slate-700 transition-colors"
              >
                <span class="font-bold text-white text-lg w-8">C</span>
                <span class="text-amber-500 font-bold">=</span>
                <span class="text-slate-200">Dó</span>
              </div>
              <div
                class="flex justify-between bg-slate-700/50 p-3 rounded items-center hover:bg-slate-700 transition-colors"
              >
                <span class="font-bold text-white text-lg w-8">D</span>
                <span class="text-amber-500 font-bold">=</span>
                <span class="text-slate-200">Ré</span>
              </div>
              <div
                class="flex justify-between bg-slate-700/50 p-3 rounded items-center hover:bg-slate-700 transition-colors"
              >
                <span class="font-bold text-white text-lg w-8">E</span>
                <span class="text-amber-500 font-bold">=</span>
                <span class="text-slate-200">Mi</span>
              </div>
              <div
                class="flex justify-between bg-slate-700/50 p-3 rounded items-center hover:bg-slate-700 transition-colors"
              >
                <span class="font-bold text-white text-lg w-8">F</span>
                <span class="text-amber-500 font-bold">=</span>
                <span class="text-slate-200">Fá</span>
              </div>
              <div
                class="flex justify-between bg-slate-700/50 p-3 rounded items-center hover:bg-slate-700 transition-colors"
              >
                <span class="font-bold text-white text-lg w-8">G</span>
                <span class="text-amber-500 font-bold">=</span>
                <span class="text-slate-200">Sol</span>
              </div>
              <div
                class="flex justify-between bg-slate-700/50 p-3 rounded items-center hover:bg-slate-700 transition-colors"
              >
                <span class="font-bold text-white text-lg w-8">A</span>
                <span class="text-amber-500 font-bold">=</span>
                <span class="text-slate-200">Lá</span>
              </div>
              <div
                class="flex justify-between bg-slate-700/50 p-3 rounded items-center hover:bg-slate-700 transition-colors"
              >
                <span class="font-bold text-white text-lg w-8">B</span>
                <span class="text-amber-500 font-bold">=</span>
                <span class="text-slate-200">Si</span>
              </div>
            </div>
          </div>

          <div
            class="bg-slate-800/90 rounded-xl p-6 border border-slate-700 shadow-lg"
          >
            <h2
              class="text-2xl text-amber-500 mb-4 cartier-font border-b border-slate-600 pb-2 flex items-center"
            >
              <span class="material-symbols-outlined mr-2" aria-hidden="true">library_music</span>
              Sintaxe & Regras
            </h2>

            <div class="space-y-6">
              <div class="flex items-start bg-slate-900/40 p-3 rounded-lg">
                <span class="text-3xl mr-4 text-amber-500 font-serif">A-G</span>
                <div>
                  <h4 class="font-bold text-white text-lg">
                    Escala Natural (Lá Menor)
                  </h4>
                  <p class="text-slate-400 text-sm mt-1">
                    Para garantir a melancolia, usamos apenas notas naturais
                    (teclas brancas).
                    <br /><span class="text-amber-600/80 italic text-xs"
                      >Não existem sustenidos (#) nesta cifra.</span
                    >
                  </p>
                </div>
              </div>

              <div class="flex items-start bg-slate-900/40 p-3 rounded-lg">
                <span class="text-3xl mr-4 text-amber-500 font-serif">3-5</span>
                <div>
                  <h4 class="font-bold text-white text-lg">Oitavas (Altura)</h4>
                  <p class="text-slate-400 text-sm mt-1">
                    O número ao lado da nota indica se ela é grave ou aguda. O
                    alfabeto foi dividido em 3 oitavas.
                  </p>
                  <ul
                    class="text-xs text-slate-300 mt-2 space-y-1 ml-1 list-disc list-inside"
                  >
                    <li>
                      <span class="text-amber-500 font-bold">3 (Grave):</span> A
                      até L
                    </li>
                    <li>
                      <span class="text-amber-500 font-bold">4 (Médio):</span> M
                      até X
                    </li>
                    <li>
                      <span class="text-amber-500 font-bold">5 (Agudo):</span> Y
                      e Z
                    </li>
                  </ul>
                </div>
              </div>

              <div
                class="bg-amber-900/20 p-4 rounded border border-amber-900/50 mt-2 text-center"
              >
                <h4 class="font-bold text-amber-500 text-sm uppercase mb-2">
                  Como ler na mesa de RPG
                </h4>
                <div
                  class="inline-block bg-black px-4 py-2 rounded border border-slate-700"
                >
                  <span class="font-mono text-2xl text-white">C#4</span>
                </div>
                <p class="text-sm text-slate-300 mt-2">
                  Você diz: <b class="text-white">"Dó Sustenido Quatro"</b>
                </p>
              </div>
            </div>
          </div>
        </div>

        <div
          class="mt-6 bg-slate-800/90 rounded-xl p-6 border border-slate-700 shadow-lg"
        >
          <h3 class="text-lg text-white font-bold mb-4 flex items-center">
            <span class="material-symbols-outlined mr-2" aria-hidden="true">grid_view</span> Tabela
            de Tradução Completa
          </h3>
          <div
            class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-9 gap-3 text-center text-xs font-mono"
            id="reference-table"
          ></div>
        </div>

        <div
          class="mt-8 pt-4 border-t border-slate-700/50 text-center animate-fade-in"
        >
          <p
            class="text-[10px] text-slate-500 font-mono uppercase tracking-widest opacity-60 hover:opacity-100 transition-opacity"
          >
            Direitos Reservados por
            <span class="text-amber-600">Daniela Vigarani</span> (Interpreta
            BiBi) & <span class="text-amber-600">Bah Duarte</span> (Interpreta
            PriPri)
          </p>
        </div>
      </section>
    </main>

    <!-- VERSÃO DO SCRIPT (Cache Busting) -->
    <script src="script.js?v=2.1"></script>
  </body>
</html>